{"remainingRequest":"C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\src\\components\\shop\\Shopevaluate.vue?vue&type=style&index=0&id=694f6f70&lang=less&scoped=true","dependencies":[{"path":"C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\src\\components\\shop\\Shopevaluate.vue","mtime":1689324886000},{"path":"C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\node_modules\\css-loader\\index.js","mtime":1709293572000},{"path":"C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1709293572000},{"path":"C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\node_modules\\less-loader\\dist\\cjs.js","mtime":1709293572000},{"path":"C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709293572000},{"path":"C:\\Users\\22075\\Desktop\\MiniProgram\\微信小程序-心理资讯\\psychology_admin_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1709293572000}],"contextDependencies":[],"result":["\r\n.tabinfo {\r\n    display: flex;\r\n\r\n    .imgbox {\r\n        width: 60px;\r\n        padding: 10px;\r\n        padding-left: 0;\r\n        position: relative;\r\n\r\n        .status_ts {\r\n            position: absolute;\r\n            width: 60px;\r\n            height: 60px;\r\n            padding-top: 18px;\r\n            top: 10px;\r\n            left: 0;\r\n            background: rgba(0, 0, 0, 0.5);\r\n            text-align: center;\r\n            color: #fff;\r\n            display: inline-block;\r\n            z-index: 1000;\r\n            border-radius: 4px;\r\n        }\r\n\r\n        .commodity-img,\r\n        .defaultimg {\r\n            cursor: pointer;\r\n            border-radius: 4px;\r\n            transition: all 0.2s;\r\n            border: 1px solid #f1f1f1;\r\n            width: 60px;\r\n            height: 60px;\r\n        }\r\n\r\n        .defaultimg {\r\n            background: #e9e9e9;\r\n            display: inline-block;\r\n            text-align: center;\r\n            padding-top: 15px;\r\n        }\r\n\r\n        // .commodity-img:hover {\r\n        //     z-index: 1000;\r\n        //     margin-left: 142px;\r\n        //     transform: scale(6);\r\n        //     position: relative;\r\n        //     z-index: 1001;\r\n        // }\r\n    }\r\n\r\n    .textbox {\r\n        margin: 10px 0 0 10px;\r\n    }\r\n}\r\n\r\n.layout-flex {\r\n    margin-bottom: 16px;\r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n    .red-text {\r\n        color: red;\r\n    }\r\n    .left {\r\n        margin-right: 8px;\r\n        text-align: right;\r\n        font-weight: 600;\r\n    }\r\n}\r\n",{"version":3,"sources":["Shopevaluate.vue"],"names":[],"mappings":";AAoMA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Shopevaluate.vue","sourceRoot":"src/components/shop","sourcesContent":["<template>\r\n    <div>\r\n        <!-- 搜索区域 -->\r\n        <el-card>\r\n            <el-select filterable v-model=\"user_id\" placeholder=\"请选择需要查看的商户\" @change=\"search\">\r\n                <el-option v-for=\"item in shopList\" :key=\"item.id\" :label=\"item.username\" :value=\"item.id\">\r\n                </el-option>\r\n            </el-select>\r\n        </el-card>\r\n\r\n        <!-- 表格区域 -->\r\n        <el-table :data=\"tableData\" border stripe>\r\n            <el-table-column label=\"序号\" type=\"index\"></el-table-column>\r\n            <el-table-column label=\"所属商户\" prop=\"user_name\"></el-table-column>\r\n            <el-table-column label=\"文章信息\">\r\n                <template slot-scope=\"scope\">\r\n                    <!-- 数据库查询不到此文章的情况 -->\r\n                    <el-tag type=\"danger\" size=\"mini\" v-if=\"JSON.stringify(scope.row.itemShopData) === '{}'\">文章已下架</el-tag>\r\n                    <div class=\"tabinfo\">\r\n                        <div class=\"imgbox\">\r\n                            <img class=\"commodity-img\" :src=\"scope.row.itemShopData.item_image\">\r\n                        </div>\r\n                        <div class=\"textbox\">\r\n                            <div>文章id：{{scope.row.shop_id}}</div>\r\n                            <div>文章标题：{{scope.row.itemShopData.item_name}}</div>\r\n                        </div>\r\n                    </div>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"评价星级\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-rate disabled v-model=\"scope.row.evaluate_start\"></el-rate>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"评价内容\" prop=\"evaluate_content\"></el-table-column>\r\n            <el-table-column label=\"操作\" width=\"150px\">\r\n                <template slot-scope=\"scope\">\r\n                    <!-- 编辑按钮 -->\r\n                    <el-button v-if=\"JSON.stringify(scope.row.itemShopData) !== '{}'\" type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" @click=\"setModal(scope.row)\"></el-button>\r\n                    <!-- 删除按钮 -->\r\n                    <el-button type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" @click=\"delEvaluate(scope.row)\"></el-button>\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n\r\n        <!-- 编辑 评价内容 弹框 -->\r\n        <el-dialog title=\"编辑评价\" :visible.sync=\"dialogVisible\">\r\n            <div class=\"tabinfo\" style=\"background-color: #efefef;\" v-if=\"shopData && shopData['itemShopData']\">\r\n                <div class=\"imgbox\">\r\n                    <img class=\"commodity-img\" :src=\"shopData['itemShopData']['item_image']\">\r\n                </div>\r\n                <div class=\"textbox\">\r\n                    <div>文章标题：{{shopData['itemShopData']['item_name']}}</div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"layout-flex\">\r\n                <div class=\"left\"><span class=\"red-text\">*</span>评价星级</div>\r\n                <div class=\"right\">\r\n                    <el-rate v-model=\"shopData['evaluate_start']\"></el-rate>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"layout-flex\">\r\n                <div class=\"left\"><span class=\"red-text\">*</span>评价内容</div>\r\n                <div class=\"right\">\r\n                    <el-input type=\"textarea\" :rows=\"2\" v-model=\"shopData['evaluate_content']\"></el-input>\r\n                </div>\r\n            </div>\r\n\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"saveData\">确 定</el-button>\r\n            </span>\r\n\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            dialogVisible: false, // 是否弹出弹框\r\n            user_id: '', // 当前选中的商户\r\n            tableData: [], // 收藏 源数据\r\n            classList: [], // 分类数据源\r\n            shopList: [], // 商户数据源\r\n            allShopList: [], // 该商户下所有文章\r\n            shopData: {}, // 需要操作的内容\r\n        }\r\n    },\r\n\r\n    created() {\r\n        this.getShopList() // 获取系统内所有文章\r\n        this.getClassList() // 获取分类\r\n        this.getUserList()\r\n    },\r\n\r\n    methods: {\r\n        // 提交修改的评价\r\n        async saveData() {\r\n            if (!this.shopData.evaluate_content) {\r\n                this.$message.error('请输入评价内容!')\r\n                return false\r\n            }\r\n\r\n            const { data: res } = await this.$http.post('editShopEvaluate', {\r\n                id: this.shopData.id,\r\n                evaluate_start: this.shopData.evaluate_start,\r\n                evaluate_content: this.shopData.evaluate_content,\r\n            })\r\n            if (res.status === 200) {\r\n                this.dialogVisible = false;\r\n                this.search()\r\n            } else {\r\n                this.$message.error(res.msg)\r\n            }\r\n        },\r\n        // 更改评价内容 星级\r\n        setModal(data) {\r\n            this.dialogVisible = true\r\n            this.shopData = JSON.parse(JSON.stringify(data))\r\n            console.log(this.shopData, '=================shopData')\r\n        },\r\n        // 删除评价\r\n        async delEvaluate(data) {\r\n            this.$confirm('此操作将无法恢复, 是否继续?', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning',\r\n            })\r\n                .then(async () => {\r\n                    const { data: res } = await this.$http.post('delShopEvaluate', {\r\n                        id: data.id,\r\n                    })\r\n                    if (res.status === 200) {\r\n                        this.search()\r\n                        this.$message.success(res.msg)\r\n                    } else {\r\n                        this.$message.error(res.msg)\r\n                    }\r\n                })\r\n                .catch(() => {})\r\n        },\r\n        // 查询评价\r\n        async search() {\r\n            // this.getShopList();\r\n            const { data: res } = await this.$http.post('getShopEvaluate', {\r\n                user_id: this.user_id,\r\n            })\r\n            if (res.status === 200) {\r\n                // this.tableData = res['data']\r\n                this.tableData = (res['data'] || []).map((item) => {\r\n                    let newarr = (this.allShopList || []).filter((fit) => item.shop_id === fit.id)\r\n                    return {\r\n                        ...item,\r\n                        itemShopData: JSON.stringify(newarr) === '[]' ? {} : newarr[0],\r\n                    }\r\n                })\r\n                console.log(this.tableData, '==================================tableData')\r\n            } else {\r\n                this.$message.error(res.msg)\r\n            }\r\n        },\r\n        // 查询系统内所有文章\r\n        async getShopList() {\r\n            const { data: res } = await this.$http.post('getAllClassContent', {})\r\n            if (res.status === 200) {\r\n                this.allShopList = res['data']\r\n            } else {\r\n                this.$message.error(res.msg)\r\n            }\r\n        },\r\n        // 获取商户\r\n        async getUserList() {\r\n            const { data: res } = await this.$http.post('getUser', {})\r\n            if (res.status === 200) {\r\n                this.shopList = res.data\r\n            } else {\r\n                this.$message.error(res.msg)\r\n            }\r\n        },\r\n        // 获取分类\r\n        async getClassList() {\r\n            const { data: res } = await this.$http.post('getClassTabs', {})\r\n            if (res.status === 200) {\r\n                this.classList = res.data\r\n            } else {\r\n                this.$message.error(res.msg)\r\n            }\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.tabinfo {\r\n    display: flex;\r\n\r\n    .imgbox {\r\n        width: 60px;\r\n        padding: 10px;\r\n        padding-left: 0;\r\n        position: relative;\r\n\r\n        .status_ts {\r\n            position: absolute;\r\n            width: 60px;\r\n            height: 60px;\r\n            padding-top: 18px;\r\n            top: 10px;\r\n            left: 0;\r\n            background: rgba(0, 0, 0, 0.5);\r\n            text-align: center;\r\n            color: #fff;\r\n            display: inline-block;\r\n            z-index: 1000;\r\n            border-radius: 4px;\r\n        }\r\n\r\n        .commodity-img,\r\n        .defaultimg {\r\n            cursor: pointer;\r\n            border-radius: 4px;\r\n            transition: all 0.2s;\r\n            border: 1px solid #f1f1f1;\r\n            width: 60px;\r\n            height: 60px;\r\n        }\r\n\r\n        .defaultimg {\r\n            background: #e9e9e9;\r\n            display: inline-block;\r\n            text-align: center;\r\n            padding-top: 15px;\r\n        }\r\n\r\n        // .commodity-img:hover {\r\n        //     z-index: 1000;\r\n        //     margin-left: 142px;\r\n        //     transform: scale(6);\r\n        //     position: relative;\r\n        //     z-index: 1001;\r\n        // }\r\n    }\r\n\r\n    .textbox {\r\n        margin: 10px 0 0 10px;\r\n    }\r\n}\r\n\r\n.layout-flex {\r\n    margin-bottom: 16px;\r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n    .red-text {\r\n        color: red;\r\n    }\r\n    .left {\r\n        margin-right: 8px;\r\n        text-align: right;\r\n        font-weight: 600;\r\n    }\r\n}\r\n</style>"]}]}